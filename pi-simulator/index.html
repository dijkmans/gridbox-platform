<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Gridbox Raspberry Pi Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f2f4f7;
    margin: 0;
    padding: 20px;
  }

  h1 {
    margin-bottom: 10px;
  }

  .container {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }

  .card {
    background: #fff;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  }

  .pi {
    width: 300px;
  }

  .gpio {
    display: flex;
    justify-content: space-between;
    margin: 6px 0;
    font-size: 14px;
  }

  .dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: #bbb;
  }

  .dot.on {
    background: #2ecc71;
  }

  .relay {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 8px 0;
  }

  .relay span {
    font-size: 14px;
  }

  .status {
    font-weight: bold;
  }

  .open {
    color: #2ecc71;
  }

  .closed {
    color: #e74c3c;
  }

  button {
    padding: 10px 14px;
    font-size: 14px;
    cursor: pointer;
  }

  .log {
    max-height: 200px;
    overflow-y: auto;
    font-size: 12px;
    background: #111;
    color: #0f0;
    padding: 10px;
    margin-top: 10px;
  }
</style>
</head>

<body>

<h1>Gridbox Raspberry Pi Simulator</h1>
<p>Visuele simulatie van GPIO, relais en fysieke knop</p>

<div class="container">

  <!-- Raspberry Pi -->
  <div class="card pi">
    <h3>Raspberry Pi</h3>

    <div class="gpio">
      <span>GPIO 8 Button</span>
      <div id="gpio-button" class="dot"></div>
    </div>

    <div class="gpio">
      <span>GPIO 26 Relay OPEN</span>
      <div id="gpio-open" class="dot"></div>
    </div>

    <div class="gpio">
      <span>GPIO 20 Relay CLOSE</span>
      <div id="gpio-close" class="dot"></div>
    </div>

    <div class="gpio">
      <span>GPIO 21 Relay LIGHT</span>
      <div id="gpio-light" class="dot"></div>
    </div>

    <div class="gpio">
      <span>Relay 4 Unused</span>
      <div class="dot"></div>
    </div>
  </div>

  <!-- Relais en bediening -->
  <div class="card" style="width:300px">
    <h3>Relais & Status</h3>

    <p>
      Rolluik status:
      <span id="shutter-status" class="status closed">GESLOTEN</span>
    </p>

    <div class="relay">
      <span>Relais OPEN</span>
      <span id="relay-open">OFF</span>
    </div>

    <div class="relay">
      <span>Relais CLOSE</span>
      <span id="relay-close">OFF</span>
    </div>

    <div class="relay">
      <span>Licht</span>
      <span id="relay-light">OFF</span>
    </div>

    <button onclick="pressButton()">Druk op fysieke knop</button>

    <button onclick="toggleLight()" style="margin-top:8px">
      Licht aan of uit
    </button>
  </div>

  <!-- Logs -->
  <div class="card" style="flex:1">
    <h3>Log</h3>
    <div id="log" class="log"></div>
  </div>

</div>

<script>
  let shutterOpen = false;
  let lightOn = false;

  function log(msg) {
    const el = document.getElementById("log");
    el.innerHTML += msg + "<br>";
    el.scrollTop = el.scrollHeight;
  }

  function pulse(dotId, relayId, label) {
    const dot = document.getElementById(dotId);
    const relay = document.getElementById(relayId);

    dot.classList.add("on");
    relay.textContent = "ON";
    log(label + " relais geactiveerd");

    setTimeout(() => {
      dot.classList.remove("on");
      relay.textContent = "OFF";
    }, 800);
  }

  function updateStatus() {
    const status = document.getElementById("shutter-status");
    if (shutterOpen) {
      status.textContent = "OPEN";
      status.className = "status open";
    } else {
      status.textContent = "GESLOTEN";
      status.className = "status closed";
    }
  }

  function pressButton() {
    const btn = document.getElementById("gpio-button");
    btn.classList.add("on");

    setTimeout(() => btn.classList.remove("on"), 300);

    if (shutterOpen) {
      log("Button ingedrukt → rolluik sluiten");
      shutterOpen = false;
      pulse("gpio-close", "relay-close", "ROLLUIK SLUITEN");
    } else {
      log("Button ingedrukt → rolluik openen");
      shutterOpen = true;
      pulse("gpio-open", "relay-open", "ROLLUIK OPENEN");
    }

    updateStatus();
  }

  function toggleLight() {
    lightOn = !lightOn;
    const dot = document.getElementById("gpio-light");
    const relay = document.getElementById("relay-light");

    if (lightOn) {
      dot.classList.add("on");
      relay.textContent = "ON";
      log("Licht aangezet");
    } else {
      dot.classList.remove("on");
      relay.textContent = "OFF";
      log("Licht uitgezet");
    }
  }

  log("Simulator gestart");
</script>

</body>
</html>
